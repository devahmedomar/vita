"use strict";(self.webpackChunkVitaparapharma=self.webpackChunkVitaparapharma||[]).push([[736],{9736:(R,b,c)=>{c.r(b),c.d(b,{CartModule:()=>$});var l=c(6814),u=c(8209),t=c(9291),Z=c(4817),x=c(3911),p=c(1299),g=c(281),h=c(2785),i=c(6223),v=c(9560);const T=function(n){return["/shop/",n]};function A(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td",20)(2,"div",21)(3,"div",22),t._UZ(4,"img",23),t.qZA(),t.TgZ(5,"div",24)(6,"h3"),t._uU(7),t.qZA(),t.TgZ(8,"p",25),t._uU(9),t.ALo(10,"currency"),t.qZA()()()(),t.TgZ(11,"td")(12,"div",26)(13,"p-inputNumber",27),t.NdJ("ngModelChange",function(r){const d=t.CHM(e).$implicit;return t.KtG(d.quantity=r)})("ngModelChange",function(){const a=t.CHM(e).$implicit,d=t.oxw(2);return t.KtG(d.updateSubtotal(a))}),t.qZA()()(),t.TgZ(14,"td",28)(15,"div"),t._uU(16),t.ALo(17,"currency"),t.qZA()(),t.TgZ(18,"td",28)(19,"button",29),t.NdJ("click",function(){const a=t.CHM(e).$implicit,d=t.oxw(2);return t.KtG(d.removeFromCart(a.productId))}),t._uU(20,"X"),t.qZA()()()}if(2&n){const e=s.$implicit;t.xp6(2),t.Q6J("routerLink",t.VKq(14,T,e.productId)),t.xp6(2),t.Q6J("src",e.pictureUrl,t.LSH),t.xp6(3),t.Oqu(e.productName),t.xp6(2),t.Oqu(t.lcZ(10,10,e.productPrice)),t.xp6(4),t.Q6J("ngModel",e.quantity)("showButtons",!0)("min",1)("max",e.stockQuantity)("disabled",0===e.stockQuantity),t.xp6(3),t.Oqu(t.lcZ(17,12,e.subtotal))}}function M(n,s){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",6)(2,"table",7)(3,"thead")(4,"tr")(5,"th",8),t._uU(6,"PRODUCT"),t.qZA(),t._UZ(7,"th"),t.TgZ(8,"th",8),t._uU(9,"QUANTITY"),t.qZA(),t.TgZ(10,"th",8),t._uU(11,"SUBTOTAL"),t.qZA(),t._UZ(12,"th",8),t.qZA()(),t.TgZ(13,"tbody"),t.YNc(14,A,21,16,"tr",9),t.qZA()()(),t.TgZ(15,"div",10)(16,"div",11)(17,"div",12),t._uU(18,"Subtotal"),t.qZA(),t.TgZ(19,"div",13),t._uU(20),t.ALo(21,"currency"),t.qZA()(),t.TgZ(22,"h4",14),t._uU(23,"SHIPPING"),t.qZA(),t.TgZ(24,"div",15)(25,"div",16),t._uU(26,"Shipping cost"),t.qZA(),t.TgZ(27,"div",13),t._uU(28),t.ALo(29,"currency"),t.qZA()(),t.TgZ(30,"div",17)(31,"div",16),t._uU(32,"TOTAL"),t.qZA(),t.TgZ(33,"div",13),t._uU(34),t.ALo(35,"currency"),t.qZA()(),t.TgZ(36,"div",18)(37,"button",19),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.checkout())}),t._uU(38,"CHECKOUT"),t.qZA()()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(14),t.Q6J("ngForOf",e.cartProducts),t.xp6(6),t.Oqu(t.lcZ(21,4,e.cartSubtotal)),t.xp6(8),t.Oqu(t.lcZ(29,6,e.shippingCost)),t.xp6(6),t.Oqu(t.lcZ(35,8,e.cartTotal))}}function P(n,s){1&n&&(t.TgZ(0,"div",30),t.O4$(),t.TgZ(1,"svg",31)(2,"g",32),t._UZ(3,"path",33),t.qZA(),t.TgZ(4,"defs")(5,"clipPath",34),t._UZ(6,"rect",35),t.qZA()()(),t.kcU(),t.TgZ(7,"h3",36),t._uU(8,"YOUR CART IS CURRENTLY"),t._UZ(9,"br"),t._uU(10," EMPTY"),t.qZA(),t.TgZ(11,"button",37),t._uU(12,"Return To Shop"),t.qZA()())}function U(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",38)(1,"p",39),t._uU(2,"Please add products to your cart first."),t.qZA(),t.TgZ(3,"button",40),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.closeNotification())}),t._uU(4,"Close"),t.qZA()()}}let q=(()=>{class n{constructor(e,o,r){this._Router=e,this.cartService=o,this.translate=r,this.cartBreadCrumbData={title:"CART",prev:"HOME"},this.cartProducts=[],this.subtotal=0,this.cartSubtotal=0,this.shippingCost=0,this.cartTotal=0,this.showCheckoutError=!1}ngOnInit(){this.loadCart()}loadCart(){this.cartService.getCart().subscribe(e=>{e.success?(this.cartProducts=e.data.cart.cartItems,this.cartProducts.forEach(o=>{const r=localStorage.getItem(`product_${o.productId}_quantity`);r&&(o.quantity=parseInt(r,10)),o.subtotal=o.quantity*o.productPrice}),this.calculateCartValues()):console.error("Failed to fetch cart data:",e.message)},e=>{console.error("Error fetching cart data:",e)})}calculateCartValues(){this.cartSubtotal=this.cartService.calculateSubtotal(this.cartProducts),this.cartTotal=this.cartService.calculateCartTotal(this.cartSubtotal,this.shippingCost)}updateSubtotal(e){e.subtotal=e.quantity*e.productPrice,this.calculateCartValues(),this.cartService.updateCart(e.productId,e.quantity).subscribe(o=>{o.success?this.cartService.setSelectedQuantity(e.quantity):console.error("Failed to update product quantity in cart:",o.message)},o=>{console.error("Error updating product quantity in cart:",o)})}removeFromCart(e){this.cartService.removeFromCart(e).subscribe(o=>{o.success?(this.cartProducts=this.cartProducts.filter(r=>r.productId!==e),this.calculateCartValues()):console.error("Failed to remove product from cart:",o.message)},o=>{console.error("Error removing product from cart:",o)})}checkout(){0===this.cartProducts.length?(this.showCheckoutError=!0,setTimeout(()=>{this.showCheckoutError=!1},3e3)):this._Router.navigate(["/cart/checkout"])}closeNotification(){this.showCheckoutError=!1}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(u.F0),t.Y36(Z.N),t.Y36(x.sK))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-cart"]],decls:9,vars:4,consts:[[3,"breadcrumbData"],[1,"container","my-4"],[1,"row"],[4,"ngIf","ngIfElse"],["emptyCart",""],["class","custom-notification error",4,"ngIf"],[1,"col-md-8"],[1,"table"],["scope","col",1,"text-muted","fs-6","fw-light"],[4,"ngFor","ngForOf"],[1,"col-md-4","bg-white","p-4"],[1,"row","border-bottom","pb-3"],[1,"col-6","text-muted","fw-light"],[1,"col-6","d-flex","justify-content-end","fw-bolder"],[1,"my-4","fs-6"],[1,"row","border-bottom","pb-5"],[1,"col-6","fw-light"],[1,"row","pb-3","pt-3"],[1,"d-flex","justify-content-center"],[1,"btn-main",3,"click"],["colspan","2"],[1,"row","contain",3,"routerLink"],[1,"col-3"],["alt","",1,"prodimage",3,"src"],[1,"col-9","px-4","py-2","desc"],[1,"m-0","p-0","text-muted"],[1,"bg-white","py-3"],["buttonLayout","horizontal","spinnerMode","horizontal","inputId","horizontal","decrementButtonClass","p-button-incdec","incrementButtonClass","p-button-incdec","incrementButtonIcon","pi pi-plus","decrementButtonIcon","pi pi-minus",3,"ngModel","showButtons","min","max","disabled","ngModelChange"],[1,"py-3"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"col-12","text-center","py-5","bg-white"],["width","80","height","90","viewBox","0 0 80 90","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0_43_5429)"],["d","M6.23242 18.3C6.23242 17.7 6.38242 17.25 6.68242 16.95C6.98242 16.65 7.43242 16.5 8.03242 16.5H71.9324C72.3324 16.5 72.7324 16.65 73.1324 16.95C73.5324 17.25 73.7324 17.7 73.7324 18.3L79.4324 90H0.232422L6.23242 18.3ZM8.03242 18.3C7.83242 18.3 7.73242 18.3 7.73242 18.3L2.03242 88.2H77.6324L71.9324 18.3H8.03242ZM27.5324 66.9C27.5324 66.3 27.8324 66 28.4324 66H51.5324C51.9324 66 52.1824 66.15 52.2824 66.45C52.3824 66.75 52.3824 67 52.2824 67.2C52.1824 67.4 51.9324 67.5 51.5324 67.5H28.4324C28.0324 67.5 27.7824 67.45 27.6824 67.35C27.5824 67.25 27.5324 67.1 27.5324 66.9ZM26.0324 13.8C26.0324 10 27.3824 6.75 30.0824 4.05C32.7824 1.35 36.0324 0 39.8324 0C43.6324 0 46.8824 1.35 49.5824 4.05C52.2824 6.75 53.6324 10 53.6324 13.8V31.5C53.6324 32.1 53.3324 32.4 52.7324 32.4C52.1324 32.4 51.8324 32.1 51.8324 31.5V13.8C51.8324 10.6 50.6824 7.8 48.3824 5.39999C46.0824 3 43.2824 1.8 39.9824 1.8C36.6824 1.8 33.8324 3 31.4324 5.39999C29.0324 7.8 27.8324 10.6 27.8324 13.8V31.5C27.8324 32.1 27.5324 32.4 26.9324 32.4C26.3324 32.4 26.0324 32.1 26.0324 31.5V13.8ZM31.7324 48.3C31.3324 48.3 31.1324 48.5 31.1324 48.9C31.1324 49.3 31.3324 49.5 31.7324 49.5C32.1324 49.5 32.3324 49.3 32.3324 48.9C32.3324 48.5 32.1324 48.3 31.7324 48.3ZM29.3324 48.9C29.3324 47.9 29.7324 47.2 30.5324 46.8C31.3324 46.4 32.1324 46.4 32.9324 46.8C33.7324 47.2 34.1324 47.8 34.1324 48.6C34.1324 49.4 33.8824 50.05 33.3824 50.55C32.8824 51.05 32.3324 51.3 31.7324 51.3C31.1324 51.3 30.5824 51.05 30.0824 50.55C29.5824 50.05 29.3324 49.5 29.3324 48.9ZM48.2324 48.3C47.8324 48.3 47.6324 48.5 47.6324 48.9C47.6324 49.3 47.8324 49.5 48.2324 49.5C48.6324 49.5 48.8324 49.3 48.8324 48.9C48.8324 48.5 48.6324 48.3 48.2324 48.3ZM45.8324 48.9C45.8324 47.9 46.2324 47.2 47.0324 46.8C47.8324 46.4 48.5824 46.4 49.2824 46.8C49.9824 47.2 50.3324 47.8 50.3324 48.6C50.3324 49.4 50.1324 50.05 49.7324 50.55C49.3324 51.05 48.7824 51.3 48.0824 51.3C47.3824 51.3 46.8324 51.05 46.4324 50.55C46.0324 50.05 45.8324 49.5 45.8324 48.9Z","fill","#616161"],["id","clip0_43_5429"],["width","79.53","height","90","fill","white","transform","matrix(1 0 0 -1 0.22998 90)"],[1,"py-4","not-bold"],["routerLink","/shop",1,"shopBtn","py-2","px-4","my-3"],[1,"custom-notification","error"],[1,"message"],[1,"close-button",3,"click"]],template:function(o,r){if(1&o&&(t._UZ(0,"app-navbar")(1,"app-breadcrumb",0),t.TgZ(2,"div",1)(3,"div",2),t.YNc(4,M,39,10,"ng-container",3),t.YNc(5,P,13,0,"ng-template",null,4,t.W1O),t.qZA()(),t.YNc(7,U,5,0,"div",5),t._UZ(8,"app-footer")),2&o){const a=t.MAs(6);t.xp6(1),t.Q6J("breadcrumbData",r.cartBreadCrumbData),t.xp6(3),t.Q6J("ngIf",r.cartProducts.length>0)("ngIfElse",a),t.xp6(3),t.Q6J("ngIf",r.showCheckoutError)}},dependencies:[l.sg,l.O5,p.S,g.c,h.L,u.rH,i.JJ,i.On,v.Rn,l.H9],styles:[".prodimage[_ngcontent-%COMP%]{width:100px;height:70px}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--whiteGray)!important}table[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;color:#000;line-height:22px;font-weight:400}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:middle!important}@media (min-width:320px){.contain[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column}.prodimage[_ngcontent-%COMP%]{width:80px;height:50px;text-align:center}.desc[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:10px}.desc[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}}.custom-notification[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);padding:20px;border-radius:8px;background-color:#f44336cc;color:#fff;font-size:18px;text-align:center;z-index:1000;box-shadow:0 8px 16px #0000004d}.message[_ngcontent-%COMP%]{margin-bottom:10px}.close-button[_ngcontent-%COMP%]{background:none;border:none;color:#fff;cursor:pointer;font-weight:700}.not-bold[_ngcontent-%COMP%]{font-weight:400}.shopBtn[_ngcontent-%COMP%]{font-weight:400;background-color:transparent;border:1px solid #80aa27;color:#80aa27;text-transform:uppercase}"]})}return n})();var m=c(9862),y=c(7398),C=c(6306),_=c(8504);let k=(()=>{class n{constructor(e){this.http=e,this.apiUrl="https://api.vitaparapharma.com/api/v2/",this.apiUrl2="https://api.vitaparapharma.com/api/v2/user/address/all"}getRegions(){return this.http.get(`${this.apiUrl}public/country-city-region`).pipe((0,y.U)(e=>{if(e.success)return e.data;throw new Error(e.message||"Failed to fetch regions.")}),(0,C.K)(e=>(console.error("Error fetching regions:",e),(0,_._)("Error fetching regions: "+(e.message||"Unknown error")))))}addAddress(e){const o=localStorage.getItem("eToken");if(!o)throw new Error("Authentication token not found.");const r=new m.WM({Authorization:`Bearer ${o}`,"Content-Type":"application/json"});return this.http.post(`${this.apiUrl}user/address/new`,e,{headers:r}).pipe((0,C.K)(a=>{throw console.error("Error adding address:",a),new Error("Error adding address: "+a.message)}))}getAddresses(e){if(!e)return(0,_._)("Authentication token not provided.");const o=new m.WM({"Content-Type":"application/json",Authorization:`Bearer ${e}`});return this.http.get(this.apiUrl2,{headers:o}).pipe((0,y.U)(r=>{if(r&&r.data&&r.data.addresses)return r.data.addresses;throw new Error("Failed to fetch addresses.")}),(0,C.K)(r=>(console.error("Error fetching addresses:",r),(0,_._)("Error fetching addresses: "+(r.message||"Unknown error")))))}static#t=this.\u0275fac=function(o){return new(o||n)(t.LFG(m.eN))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var O=c(1855);function w(n,s){if(1&n&&(t.TgZ(0,"option",70),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.en)}}function S(n,s){if(1&n&&(t.TgZ(0,"option",70),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.en)}}function N(n,s){if(1&n&&(t.TgZ(0,"option",70),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.en)}}function I(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",71)(1,"div")(2,"strong"),t._uU(3),t.qZA(),t._UZ(4,"br"),t._uU(5),t.qZA(),t.TgZ(6,"input",72),t.NdJ("change",function(){const a=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.onAddressSelection(a.addressId))}),t.qZA()()}if(2&n){const e=s.$implicit;t.xp6(3),t.Oqu(e.country),t.xp6(2),t.HOy(" ",e.city,", ",e.region,", ",e.description,", ",e.zipCode," "),t.xp6(1),t.Q6J("value",e.addressId)}}function F(n,s){if(1&n&&(t.TgZ(0,"div",73),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}function E(n,s){if(1&n&&(t.TgZ(0,"tr")(1,"td",74),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"currency"),t.qZA()()),2&n){const e=s.$implicit;t.xp6(2),t.Oqu(e.productName),t.xp6(2),t.Oqu(e.quantity),t.xp6(2),t.Oqu(t.lcZ(7,4,e.productPrice)),t.xp6(3),t.Oqu(t.lcZ(10,6,e.subtotal))}}function J(n,s){1&n&&(t.TgZ(0,"div",75),t._UZ(1,"input",76),t.TgZ(2,"div",77),t._UZ(3,"input",78)(4,"input",79),t.qZA(),t._UZ(5,"input",80),t.qZA())}let L=(()=>{class n{constructor(e,o,r,a,d,j){this.fb=e,this.router=o,this.addressService=r,this.cartService=a,this.orderService=d,this.translate=j,this.authToken=localStorage.getItem("eToken"),this.shippingAddresses=[],this.countries=[],this.cities=[],this.regions=[],this.defaultCountryName="Morocco",this.cartProducts=[],this.cartSubtotal=0,this.cartTotal=0,this.shippingCost=0,this.selectedAddressId=0,this.errorMessage="",this.checkoutBreadCrumbData={title:"CHECKOUT",prev:"HOME"},this.paymentForm=this.fb.group({paymentMethod:["cod"],bankName:[""],accountNumber:[""],accountHolderName:[""],cardNumber:[""],expirationDate:[""],cvv:[""],cardHolderName:[""],agreeToTerms:[!1,i.kI.requiredTrue]}),this.couponForm=this.fb.group({couponCode:[""]}),this.addressForm=this.fb.group({country:[null,i.kI.required],city:["",i.kI.required],region:["",i.kI.required],zipCode:["",[i.kI.required,i.kI.minLength(4)]],description:["",i.kI.required],orderNotes:[""]})}ngOnInit(){this.loadCountries(),this.loadShippingAddresses(),this.loadCart()}loadCart(){this.cartService.getCart().subscribe(e=>{e.success&&e.data&&e.data.cart&&e.data.cart.cartItems?(this.cartProducts=e.data.cart.cartItems,this.calculateCartSubtotal()):console.error("Invalid cart data format:",e)},e=>{console.error("Failed to fetch cart data:",e)})}calculateCartSubtotal(){this.cartProducts.forEach(e=>{e.subtotal=e.quantity*e.productPrice}),this.cartSubtotal=this.cartProducts.reduce((e,o)=>e+(o.subtotal||0),0),this.cartTotal=this.cartService.calculateCartTotal(this.cartSubtotal,this.shippingCost)}loadShippingAddresses(){this.authToken?this.addressService.getAddresses(this.authToken).subscribe(e=>{this.shippingAddresses=e},e=>{console.error("Error fetching addresses:",e)}):console.error("Authentication token not found.")}loadCountries(){this.addressService.getRegions().subscribe(e=>{this.countries=e;const o=this.countries.find(r=>r.en===this.defaultCountryName);o&&(this.addressForm.patchValue({country:o.id}),this.cities=o.cities,this.onCountryChange({target:{value:o.id}}))},e=>{console.error("Error fetching countries:",e)})}onCountryChange(e){const o=e.target.value,r=this.countries.find(a=>a.id===+o);this.cities=r?r.cities:[],this.regions=[],this.addressForm.patchValue({city:"",region:""})}onCityChange(e){const o=e.target.value,r=this.cities.find(a=>a.id===+o);this.regions=r?r.regions:[],this.addressForm.patchValue({region:""})}onAddressSubmit(){this.addressForm.valid?this.addressService.addAddress({regionId:this.addressForm.value.region,zipCode:this.addressForm.value.zipCode,description:this.addressForm.value.description}).subscribe(o=>{console.log("Address added successfully:",o),this.addressForm.reset(),this.loadShippingAddresses()},o=>{console.error("Error adding address:",o)}):console.error("Address form is invalid")}getAddressList(e){this.addressService.getAddresses(e).subscribe(o=>{this.shippingAddresses=o},o=>{console.error("Error fetching addresses:",o)})}onAddressSelection(e){this.selectedAddressId=e,console.log("Selected Address ID:",this.selectedAddressId)}onSubmit(){}applyCoupon(){const e=this.couponForm?.get("couponCode")?.value;console.log("Applying coupon:",e)}placeOrder(){if(!this.selectedAddressId)return void this.showTemporaryMessage("Please select a shipping address.");const e=this.cartProducts.map(r=>({productId:r.productId,quantity:r.quantity})),o=this.couponForm.get("couponCode")?.value||"";console.log("Order Items:",e),console.log("Coupon:",o),console.log("Selected Address ID:",this.selectedAddressId),this.authToken?this.checkOrder(e,o):this.showTemporaryMessage("Authentication token not found. Please log in and try again.")}checkOrder(e,o){this.orderService.checkOrder(this.authToken,e,o).subscribe(r=>{console.log("Order checked successfully:",r),this.addOrder(e,o)},r=>{this.handleCheckOrderError(r)})}addOrder(e,o){this.orderService.addOrder(this.authToken,this.selectedAddressId.toString(),e,o).subscribe(r=>{console.log("Order placed successfully:",r),this.cartProducts.forEach(a=>{this.cartService.removeFromCart(a.productId).subscribe(()=>{console.log(`Removed product ${a.productId} from cart.`)},d=>{console.error(`Error removing product ${a.productId} from cart:`,d)})}),this.router.navigate(["/cart/placeorder"])},r=>{this.handleAddOrderError(r)})}handleCheckOrderError(e){if(400===e.status)if(e.error&&e.error.message){let o="";o="Entity Product have no sufficient amount"===e.error.message?"One or more products in your order are out of stock. Please adjust the quantity or try again later.":"Failed to check order. Please try again later.",this.showTemporaryMessage(o)}else this.showTemporaryMessage("Failed to check order due to a bad request. Please try again later.");else this.showTemporaryMessage("Failed to check order. Please try again later.")}handleAddOrderError(e){if(400===e.status)if(e.error&&e.error.message){let o="";o="Entity Product have no sufficient amount"===e.error.message?"One or more products in your order are out of stock. Please adjust the quantity or try again later.":"Failed to place order. Please try again later.",this.showTemporaryMessage(o)}else this.showTemporaryMessage("Failed to place order due to a bad request. Please try again later.");else this.showTemporaryMessage("Failed to place order. Please try again later.")}showTemporaryMessage(e){this.errorMessage=e,setTimeout(()=>{this.errorMessage=""},3e3)}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(i.qu),t.Y36(u.F0),t.Y36(k),t.Y36(Z.N),t.Y36(O.p),t.Y36(x.sK))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-checkout"]],decls:142,vars:18,consts:[[3,"breadcrumbData"],[1,"container","my-4","checkout"],[1,"row"],[1,"col-md-8"],[1,"card"],[1,"card-body"],[1,"card-title"],["id","accordionExample",1,"accordion"],[1,"accordion-item"],[1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseTwo","aria-expanded","true","aria-controls","collapseTwo",1,"accordion-button","fs-4","text-black"],["id","collapseTwo","data-bs-parent","#accordionExample",1,"accordion-collapse","collapse"],[1,"accordion-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","country"],["id","country","formControlName","country","required","",1,"form-control",3,"change"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","city"],["id","city","formControlName","city","required","",1,"form-control",3,"change"],["for","region"],["id","region","formControlName","region","required","",1,"form-control"],["for","streetAddress"],["type","text","id","streetAddress","formControlName","description","placeholder","House number and street name","required","",1,"form-control"],["for","postcode"],["type","text","id","postcode","formControlName","zipCode","required","",1,"form-control"],["for","orderNotes"],["id","orderNotes","formControlName","orderNotes","placeholder","Notes about your order, e.g., special notes for delivery","rows","3",1,"form-control"],["type","submit",1,"confirm-button","mt-3"],[1,"bg-white","p-5","mt-5"],[1,"mb-4"],["class","address-card",4,"ngFor","ngForOf"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseTwo","aria-expanded","true","aria-controls","collapseTwo",1,"add-new-address","accordion-button","fs-4","text-black","mt-3",2,"color","var(--mainColor) !important"],[1,"pi","pi-plus","ms-2"],["class","alert alert-danger mt-3",4,"ngIf"],["type","button",1,"place-order-btn",3,"click"],[1,"col-md-4","bg-white","p-4"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseOne","aria-expanded","true","aria-controls","collapseOne",1,"accordion-button"],["id","collapseOne","data-bs-parent","#accordionExample",1,"accordion-collapse","collapse","show"],[1,"coupon-container"],[1,"coupon-input-group"],[3,"formGroup"],["type","text","formControlName","couponCode","placeholder","Coupon Code",1,"coupon-input"],["type","button",1,"apply-button",3,"click"],[1,"row","border-bottom","pb-3"],[1,"table-responsive"],[1,"table","bg-white"],["scope","col",1,"text-start"],["scope","col"],[4,"ngFor","ngForOf"],[1,"col-6","text-muted","fw-light"],[1,"col-6","d-flex","justify-content-end","fw-bolder"],[1,"my-4","fs-6"],[1,"col-6","fw-light"],[1,"row","pb-3","pt-3","total"],[1,"payment-container"],[1,"payment-method"],[1,"d-flex"],["type","radio","id","cod","formControlName","paymentMethod","value","cod",1,"me-2"],[1,"ms-3"],["for","cod"],[1,"ms-0"],["type","radio","id","bank-transfer","formControlName","paymentMethod","value","bank-transfer"],["for","bank-transfer"],["class","bank-details",4,"ngIf"],[1,"terms","d-flex"],["type","checkbox","formControlName","agreeToTerms","id","agreeToTerms"],["for","agreeToTerms",1,"ms-3"],["type","submit",1,"confirm-button"],[3,"value"],[1,"address-card"],["type","radio","name","address","aria-label","Select this address",3,"value","change"],[1,"alert","alert-danger","mt-3"],["scope","row"],[1,"bank-details"],["type","text","formControlName","cardNumber","placeholder","Card Number"],[1,"expiration-cvv"],["type","text","formControlName","expirationDate","placeholder","Expiration Date"],["type","text","formControlName","cvv","placeholder","CVV"],["type","text","formControlName","cardHolderName","placeholder","Number on Card"]],template:function(o,r){if(1&o&&(t._UZ(0,"app-navbar")(1,"app-breadcrumb",0),t.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h4",6),t._uU(8,"Billing Details"),t.qZA(),t.TgZ(9,"div",7)(10,"div",8)(11,"h2",9)(12,"button",10),t._uU(13," Add new address\xa0* "),t.qZA()(),t.TgZ(14,"div",11)(15,"div",12)(16,"form",13),t.NdJ("ngSubmit",function(){return r.onAddressSubmit()}),t.TgZ(17,"div",14)(18,"label",15),t._uU(19,"Country"),t.qZA(),t.TgZ(20,"select",16),t.NdJ("change",function(d){return r.onCountryChange(d)}),t.TgZ(21,"option",17),t._uU(22,"Select Country"),t.qZA(),t.YNc(23,w,2,2,"option",18),t.qZA()(),t.TgZ(24,"div",14)(25,"label",19),t._uU(26,"City"),t.qZA(),t.TgZ(27,"select",20),t.NdJ("change",function(d){return r.onCityChange(d)}),t.TgZ(28,"option",17),t._uU(29,"Select City"),t.qZA(),t.YNc(30,S,2,2,"option",18),t.qZA()(),t.TgZ(31,"div",14)(32,"label",21),t._uU(33,"Region"),t.qZA(),t.TgZ(34,"select",22)(35,"option",17),t._uU(36,"Select Region"),t.qZA(),t.YNc(37,N,2,2,"option",18),t.qZA()(),t.TgZ(38,"div",14)(39,"label",23),t._uU(40,"Street address"),t.qZA(),t._UZ(41,"input",24),t.qZA(),t.TgZ(42,"div",14)(43,"label",25),t._uU(44,"Postcode"),t.qZA(),t._UZ(45,"input",26),t.qZA(),t.TgZ(46,"div",14)(47,"label",27),t._uU(48,"Order notes (optional)"),t.qZA(),t._UZ(49,"textarea",28),t.qZA(),t.TgZ(50,"button",29),t._uU(51,"ADD"),t.qZA()()()()()()()(),t.TgZ(52,"div",30)(53,"h5",31),t._uU(54,"Select Shipping Address"),t.qZA(),t.YNc(55,I,7,6,"div",32),t.TgZ(56,"div",33),t._uU(57," Add New Address "),t._UZ(58,"i",34),t.qZA(),t.YNc(59,F,2,1,"div",35),t.TgZ(60,"button",36),t.NdJ("click",function(){return r.placeOrder()}),t._uU(61,"Place Order"),t.qZA()()(),t.TgZ(62,"div",37)(63,"div",7)(64,"div",8)(65,"h2",9)(66,"button",38),t._uU(67," Coupon code "),t.qZA()(),t.TgZ(68,"div",39)(69,"div",12)(70,"div",40)(71,"h3"),t._uU(72,"Coupon Code"),t.qZA(),t.TgZ(73,"div",41)(74,"form",42)(75,"div"),t._UZ(76,"input",43),t.TgZ(77,"button",44),t.NdJ("click",function(){return r.applyCoupon()}),t._uU(78,"Apply"),t.qZA()()()()()()()()(),t.TgZ(79,"div",45)(80,"div",46)(81,"table",47)(82,"thead")(83,"tr")(84,"th",48),t._uU(85,"PRODUCT"),t.qZA(),t.TgZ(86,"th",49),t._uU(87,"QUANTITY"),t.qZA(),t.TgZ(88,"th",49),t._uU(89,"PRICE"),t.qZA(),t.TgZ(90,"th",49),t._uU(91,"SUBTOTAL"),t.qZA()()(),t.TgZ(92,"tbody"),t.YNc(93,E,11,8,"tr",50),t.qZA()()(),t.TgZ(94,"div",45)(95,"div",51),t._uU(96,"Subtotal"),t.qZA(),t.TgZ(97,"div",52),t._uU(98),t.ALo(99,"currency"),t.qZA()(),t.TgZ(100,"h4",53),t._uU(101,"SHIPPING"),t.qZA(),t.TgZ(102,"div",45)(103,"div",54),t._uU(104,"Shipping cost"),t.qZA(),t.TgZ(105,"div",52),t._uU(106),t.qZA()(),t.TgZ(107,"div",55)(108,"div",54),t._uU(109,"TOTAL"),t.qZA(),t.TgZ(110,"div",52),t._uU(111),t.ALo(112,"currency"),t.qZA()(),t.TgZ(113,"div")(114,"div",56)(115,"h3"),t._uU(116,"Payment Method"),t.qZA(),t.TgZ(117,"form",13),t.NdJ("ngSubmit",function(){return r.onSubmit()}),t.TgZ(118,"div",57)(119,"div",58),t._UZ(120,"input",59),t.TgZ(121,"div",60)(122,"label",61),t._uU(123,"Cash on delivery"),t.qZA(),t.TgZ(124,"p",62),t._uU(125,"Pay with cash upon delivery."),t.qZA()()()(),t.TgZ(126,"div",57)(127,"div",58),t._UZ(128,"input",63),t.TgZ(129,"div",60)(130,"label",64),t._uU(131,"Direct bank transfer"),t.qZA(),t.TgZ(132,"p",62),t._uU(133,"Transfer money directly from your bank account."),t.qZA()()(),t.YNc(134,J,6,0,"div",65),t.qZA(),t.TgZ(135,"div",66),t._UZ(136,"input",67),t.TgZ(137,"label",68),t._uU(138,"I have read and agree to the website terms and conditions"),t.qZA()(),t.TgZ(139,"button",69),t._uU(140,"Confirm"),t.qZA()()()()()()()(),t._UZ(141,"app-footer")),2&o){let a;t.xp6(1),t.Q6J("breadcrumbData",r.checkoutBreadCrumbData),t.xp6(15),t.Q6J("formGroup",r.addressForm),t.xp6(7),t.Q6J("ngForOf",r.countries),t.xp6(7),t.Q6J("ngForOf",r.cities),t.xp6(7),t.Q6J("ngForOf",r.regions),t.xp6(18),t.Q6J("ngForOf",r.shippingAddresses),t.xp6(4),t.Q6J("ngIf",r.errorMessage),t.xp6(15),t.Q6J("formGroup",r.couponForm),t.xp6(19),t.Q6J("ngForOf",r.cartProducts),t.xp6(5),t.Oqu(t.lcZ(99,14,r.cartSubtotal)),t.xp6(8),t.hij("$",r.shippingCost,""),t.xp6(5),t.hij(" ",t.lcZ(112,16,r.cartSubtotal+r.shippingCost)," "),t.xp6(6),t.Q6J("formGroup",r.paymentForm),t.xp6(17),t.Q6J("ngIf","bank-transfer"===(null==(a=r.paymentForm.get("paymentMethod"))?null:a.value))}},dependencies:[l.sg,l.O5,p.S,g.c,h.L,i._Y,i.YN,i.Kr,i.Fj,i.Wl,i.EJ,i._,i.JJ,i.JL,i.Q7,i.sg,i.u,l.H9],styles:[".prodimage[_ngcontent-%COMP%]{width:100px;height:70px}table[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;color:#000;line-height:22px;font-weight:400}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:400;font-size:14px;line-height:18px;text-align:right;color:#616161}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{text-align:left;font-weight:400;font-size:14px;line-height:22px;color:#000}table[_ngcontent-%COMP%], .total[_ngcontent-%COMP%]{border-bottom:1px solid #61616131}.total[_ngcontent-%COMP%]{margin-bottom:20px}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){text-align:right;font-weight:500;font-size:15px;line-height:30px}.checkout-container[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;box-shadow:0 0 10px #0000001a;width:300px;margin:0 auto}h2[_ngcontent-%COMP%]{margin-bottom:20px;text-align:center}.payment-method[_ngcontent-%COMP%]{margin-bottom:10px}.bank-details[_ngcontent-%COMP%]{margin-top:20px}.bank-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0}label[_ngcontent-%COMP%]{display:block;margin-top:10px}.checkout[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border:0!important;padding:14px!important}.checkout[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .checkout[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .checkout[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:8px;margin-top:5px;background-color:var(--whiteGray);border-radius:4px}input[type=text][_ngcontent-%COMP%]{width:63%;padding:8px;margin-top:5px;border:1px solid #ccc;border-radius:4px}tbody[_ngcontent-%COMP%], td[_ngcontent-%COMP%], tfoot[_ngcontent-%COMP%]{border-style:none;border-width:0}.accordion[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{margin:0!important}.coupon-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;margin:20px}.coupon-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:10px;font-size:16px;font-weight:700}.coupon-input-group[_ngcontent-%COMP%]{display:flex}.coupon-input[_ngcontent-%COMP%]{padding:10px;border:1px solid #ccc;border-right:none;border-radius:4px 0 0 4px;outline:none;width:200px}.apply-button[_ngcontent-%COMP%]{padding:10px 20px;background-color:var(--mainColor);color:#fff;border:none;border-radius:0 4px 4px 0;cursor:pointer;outline:none}.apply-button[_ngcontent-%COMP%]:hover{background-color:var(--mainColor)}.checkout[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]{border:0!important;background-color:transparent!important}.checkout[_ngcontent-%COMP%]   .accordion-button[_ngcontent-%COMP%]:focus{box-shadow:none!important}.checkout[_ngcontent-%COMP%]   .accordion-button[_ngcontent-%COMP%]:not(.collapsed){background-color:transparent!important;box-shadow:none!important}.checkout[_ngcontent-%COMP%]   .accordion-body[_ngcontent-%COMP%]{padding:0!important}.payment-container[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;max-width:400px;margin:20px auto;font-family:Arial,sans-serif}.payment-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:20px;font-size:18px;font-weight:700}.payment-method[_ngcontent-%COMP%]{margin-bottom:20px}.payment-method[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:10px;font-size:14px;cursor:pointer}.payment-method[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-left:30px;font-size:12px;color:#666}.bank-details[_ngcontent-%COMP%]{margin-top:10px}.bank-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:10px 0 5px;font-size:14px}.bank-details[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;margin-bottom:10px;border:1px solid #ccc;border-radius:4px;font-size:14px}.expiration-cvv[_ngcontent-%COMP%]{display:flex;gap:10px}.terms[_ngcontent-%COMP%]{margin-bottom:20px;font-size:12px}.terms[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:10px}.confirm-button[_ngcontent-%COMP%]{width:100%;padding:10px;background-color:var(--mainColor);color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:16px}.confirm-button[_ngcontent-%COMP%]:hover{background-color:var(--mainColor)}.address-card[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:8px;padding:15px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center}.add-new-address[_ngcontent-%COMP%]{color:#6c757d;font-weight:700;cursor:pointer;display:inline-block;margin-bottom:20px}.add-new-address[_ngcontent-%COMP%]:hover{color:#000}.add-new-address[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:green}.place-order-btn[_ngcontent-%COMP%]{background-color:#8cc63f;color:#fff;font-weight:700;padding:10px 0;border:none;border-radius:4px;width:100%;text-transform:uppercase}"]})}return n})();function Q(n,s){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",11),t._uU(6),t.ALo(7,"currency"),t.qZA()()),2&n){const e=s.$implicit;t.xp6(2),t.Oqu(e.productName),t.xp6(2),t.Oqu(e.quantity),t.xp6(2),t.Oqu(t.lcZ(7,3,e.totalPrice))}}function Y(n,s){if(1&n&&(t.TgZ(0,"div",2)(1,"div",3)(2,"div",4),t._UZ(3,"img",5),t.TgZ(4,"h3"),t._uU(5,"Thank you. Your order has been received."),t.qZA()(),t.TgZ(6,"div",6)(7,"div",7)(8,"strong"),t._uU(9,"Order Number:"),t.qZA(),t._UZ(10,"br"),t._uU(11),t.qZA(),t.TgZ(12,"div",7)(13,"strong"),t._uU(14,"Date:"),t.qZA(),t._UZ(15,"br"),t._uU(16),t.ALo(17,"date"),t.qZA(),t.TgZ(18,"div",7)(19,"strong"),t._uU(20,"Total:"),t.qZA(),t._UZ(21,"br"),t._uU(22),t.ALo(23,"currency"),t.qZA(),t.TgZ(24,"div",7)(25,"strong"),t._uU(26,"Payment Method:"),t.qZA(),t._UZ(27,"br"),t._uU(28),t.qZA()(),t.TgZ(29,"div",8)(30,"h5",9),t._uU(31,"Order Details"),t.qZA(),t.TgZ(32,"table",10)(33,"thead")(34,"tr")(35,"th"),t._uU(36,"Product"),t.qZA(),t.TgZ(37,"th"),t._uU(38,"Quantity"),t.qZA(),t.TgZ(39,"th",11),t._uU(40,"Total"),t.qZA()()(),t.TgZ(41,"tbody"),t.YNc(42,Q,8,5,"tr",12),t.TgZ(43,"tr")(44,"td",13)(45,"strong"),t._uU(46,"Subtotal:"),t.qZA()(),t.TgZ(47,"td",11),t._uU(48),t.ALo(49,"currency"),t.qZA()(),t.TgZ(50,"tr")(51,"td",13)(52,"strong"),t._uU(53,"Shipping:"),t.qZA()(),t.TgZ(54,"td",11),t._uU(55),t.ALo(56,"currency"),t.qZA()(),t.TgZ(57,"tr")(58,"td",13)(59,"strong"),t._uU(60,"Total:"),t.qZA()(),t.TgZ(61,"td",11),t._uU(62),t.ALo(63,"currency"),t.qZA()()()()()()()),2&n){const e=t.oxw();t.xp6(11),t.hij("",e.lastOrder.orderId," "),t.xp6(5),t.hij("",t.xi3(17,8,e.lastOrder.orderDate,"MMMM d, yyyy")," "),t.xp6(6),t.hij("",t.lcZ(23,11,e.lastOrder.totalAmount)," "),t.xp6(6),t.hij("",e.paymentMethod," "),t.xp6(14),t.Q6J("ngForOf",e.lastOrder.orderItems),t.xp6(6),t.Oqu(t.lcZ(49,13,e.getSubtotal(e.lastOrder))),t.xp6(7),t.Oqu(t.lcZ(56,15,0)),t.xp6(7),t.Oqu(t.lcZ(63,17,e.getTotal(e.lastOrder)))}}let z=(()=>{class n{constructor(e,o,r){this.orderService=e,this.route=o,this.router=r,this.lastOrder=null,this.paymentMethod="Cash on delivery",this.placeorderBread={prev:"HOME",title:"CHECKOUT"}}ngOnInit(){this.loadOrders()}loadOrders(){this.orderService.getAllOrders().subscribe(e=>{if(e.success&&e.data&&e.data.orders){const o=e.data.orders;o.sort((r,a)=>new Date(a.orderDate).getTime()-new Date(r.orderDate).getTime()),this.lastOrder=o.length>0?o[0]:null,console.log(this.lastOrder)}else console.error("Invalid orders data format:",e)},e=>{console.error("Failed to fetch orders:",e)})}getSubtotal(e){return e.orderItems.reduce((o,r)=>o+r.totalPrice,0)}getTotal(e){return this.getSubtotal(e)}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(O.p),t.Y36(u.gz),t.Y36(u.F0))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-placeorder"]],decls:4,vars:2,consts:[[3,"breadcrumbData"],["class","container",4,"ngIf"],[1,"container"],[1,"bg-white","p-5"],[1,"order-confirmation"],["src","assets/images/icons/placeorder.png","alt","Order Icon"],[1,"row","order-details"],[1,"col-md-3","text-center"],[1,"order-summary","mt-4"],[1,"text-left"],[1,"table"],[1,"text-right"],[4,"ngFor","ngForOf"],["colspan","2",1,"text-right"]],template:function(o,r){1&o&&(t._UZ(0,"app-navbar")(1,"app-breadcrumb",0),t.YNc(2,Y,64,19,"div",1),t._UZ(3,"app-footer")),2&o&&(t.xp6(1),t.Q6J("breadcrumbData",r.placeorderBread),t.xp6(1),t.Q6J("ngIf",r.lastOrder))},dependencies:[l.sg,l.O5,p.S,g.c,h.L,l.H9,l.uU],styles:[".order-confirmation[_ngcontent-%COMP%]{text-align:center;margin-top:50px}.order-confirmation[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;margin-bottom:20px}.order-details[_ngcontent-%COMP%]{margin-top:30px}.order-summary[_ngcontent-%COMP%]{margin-top:20px}.order-summary[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .order-summary[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;border-top:none}.order-summary[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{font-weight:700}"]})}return n})();var f=c(1391);const H=[{path:"",component:q,title:"Shopping Cart",canActivate:[f.p]},{path:"checkout",component:L,title:"Checkout",canActivate:[f.p]},{path:"placeorder",component:z,title:"place order",canActivate:[f.p]}];let B=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#o=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(H),u.Bz]})}return n})();var D=c(8169);let $=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#o=this.\u0275inj=t.cJS({imports:[l.ez,D.m,B,i.UX,i.u5,v.L$]})}return n})()}}]);